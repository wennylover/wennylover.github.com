<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: rails | 默言，在路上]]></title>
  <link href="http://wennylover.github.com/blog/categories/rails/atom.xml" rel="self"/>
  <link href="http://wennylover.github.com/"/>
  <updated>2013-03-08T10:06:59+09:00</updated>
  <id>http://wennylover.github.com/</id>
  <author>
    <name><![CDATA[默言]]></name>
    <email><![CDATA[rugang6891@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[rails应用中timezones的正确用法]]></title>
    <link href="http://wennylover.github.com/blog/2013/03/08/the-guide-to-rails-time-zones/"/>
    <updated>2013-03-08T11:08:00+09:00</updated>
    <id>http://wennylover.github.com/blog/2013/03/08/the-guide-to-rails-time-zones</id>
    <content type="html"><![CDATA[<h3>说明</h3>

<hr />

<p>本文参照翻译了以下博文:</p>

<p><a href="http://danilenko.org/2012/7/6/rails_timezones/">The Exhaustive Guide to Rails Time Zones</a><br/>
作者: Alexander</p>

<h3>正文</h3>

<hr />

<ul>
<li>得到当前时间

<blockquote><p><code>正确做法</code><br/>
Time.zone.now</p>

<p><code>可接受做法</code><br/>
Time.now.in_time_zone<br/>
DateTime.now.in_time_zone</p>

<p><code>错误做法</code><br/>
Time.now<br/>
DateTime.now</p></blockquote></li>
<li>得到日期（比如今天，昨天等）

<blockquote><p><code>正确做法</code><br/>
Time.zone.today<br/>
Time.zone.today - 1.day</p>

<p><code>可接受做法</code><br/>
Date.current<br/>
Date.yesterday</p>

<p><code>错误做法</code><br/>
Date.today</p></blockquote></li>
<li>生成Time（Build Time）

<blockquote><p><code>正确做法</code><br/>
Time.zone.local(2013, 3, 8, 10, 00)</p>

<p><code>错误做法</code><br/>
Time.new(2013, 3, 8, 10, 00)<br/>
DateTime.new(2013, 3, 8, 10, 00)</p></blockquote></li>
<li>从时间戳生成Time（Time from Timestamp）

<blockquote><p><code>正确做法</code><br/>
Time.zone.at(Timestamp)</p>

<p><code>可接受做法</code><br/>
Time.at(Timestamp).in_time_zone</p>

<p><code>错误做法</code><br/>
Time.at(Timestamp)</p></blockquote></li>
<li>解析时间（简单）

<blockquote><p><code>正确做法</code><br/>
Time.zone.parse(str)</p>

<p><code>错误做法</code><br/>
Time.parse(str)</p></blockquote></li>
<li>解析时间（按照严格格式）

<blockquote><p><code>正确做法</code><br/>
Time.zone.strptime(str, "%Y-%m-%d %H:%M %Z")<br/>
注意：这种比较好的做法，需要引入作者自己写的gem。<a href="https://github.com/doz/time_zone_ext">TimeZoneExt</a></p>

<p><code>可接受做法</code><br/>
DateTime.strptime(str, "%Y-%m-%d %H:%M %Z").in_time_zone</p>

<p><code>错误做法</code><br/>
DateTime.strptime(str, "%Y-%m-%d %H:%M %Z")</p></blockquote></li>
<li>日期转时间（Get Time From Date）

<blockquote><p><code>正确做法</code><br/>
date.beginning_of_day</p>

<p><code>可接受做法</code><br/>
date.to_time_in_current_zone</p>

<p><code>错误做法</code><br/>
date.to_time</p></blockquote></li>
</ul>


<h3>注意事项</h3>

<hr />

<ul>
<li>ruby的标准库中，比如Time和DateTime类是没有考虑时区（TimeZone）的概念在里面的。</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby,Rails的一些概念和注意点]]></title>
    <link href="http://wennylover.github.com/blog/2013/02/05/ruby-rails-tips/"/>
    <updated>2013-02-05T14:39:00+09:00</updated>
    <id>http://wennylover.github.com/blog/2013/02/05/ruby-rails-tips</id>
    <content type="html"><![CDATA[<h4>Ruby,Rails的一些概念</h4>

<hr />

<ul>
<li>rvm: ruby version manager, Ruby版本管理工具</li>
<li>gem(rubygem): 一个ruby程序，用来管理gem包的安装等，类似linux下的apt-get<br/>
  ruby1.9.2以前版本需要 <code>require 'rubygems'</code> ，ruby1.9.2开始已经自动包含gem。</li>
<li>bundle: 用来管理一个rails web工程的所有gem包的依赖，版本等。</li>
<li>rake: 一个gem包，也就是一个ruby程序，作用是用来执行其他用ruby开发的task的程序。</li>
<li>rack: A Ruby Webserver interface.是一个提供了一个ruby web服务器和ruby web框架之间的最小接口的gem程序。主要是web框架开发者用的。</li>
</ul>


<h4>Ruby,Rails的一些注意点</h4>

<hr />

<ul>
<li>.ru后缀的文件就是rackup文件。比如rails应用中的config.ru,可以通过 <code>rackup config.ru</code> 来执行rackup文件。</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[在局域网（LAN）中访问webrick服务器速度过慢]]></title>
    <link href="http://wennylover.github.com/blog/2013/01/25/access-slow-of-webrick-in-the-lan/"/>
    <updated>2013-01-25T16:09:00+09:00</updated>
    <id>http://wennylover.github.com/blog/2013/01/25/access-slow-of-webrick-in-the-lan</id>
    <content type="html"><![CDATA[<h3>问题现象描述</h3>

<hr />

<p>在Linux虚拟机中进行rails开发和server构建，通过外边的windows访问应用时，
速度很慢。</p>

<h3>对策一</h3>

<hr />

<p>参考帖子:  http://www.flatws.cn/article/program/ruby/2011-05-01/23456.html</p>

<p>帖子内容总结（修改了两个文件）<br/>
修改文件1</p>

<pre><code>路径：/usr/local/rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick
文件：server.rb
方法：GenericServer#start_thread
代码：
addr = sock.peeraddr 改为 addr = sock.peeraddr(:numeric)
</code></pre>

<p>修改文件2</p>

<pre><code>路径：/usr/local/rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick
文件：httprequest.rb
方法：HTTPRequest#parse
代码：
@peeraddr = socket.respond_to?(:peeraddr) ? socket.peeraddr : []
改为
@peeraddr = socket.respond_to?(:peeraddr) ? socket.peeraddr(:numeric ) : []
</code></pre>

<h3>对策二</h3>

<hr />

<p>修改内容如下</p>

<pre><code>修改文件：#{RUBY_HOME}/lib/ruby/1.9.1/webrick/config.rb 
:DoNotReverseLookup =&gt; nil
改为
:DoNotReverseLookup =&gt; true
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[WindowsでNetBeansでrailsのDebug環境の構築(失敗した)]]></title>
    <link href="http://wennylover.github.com/blog/2013/01/25/the-install-of-rails-debug-env-of-netbeans-on-windows/"/>
    <updated>2013-01-25T15:36:00+09:00</updated>
    <id>http://wennylover.github.com/blog/2013/01/25/the-install-of-rails-debug-env-of-netbeans-on-windows</id>
    <content type="html"><![CDATA[<h3>前言</h3>

<hr />

<p>这里只是单纯的记录了自己在windows中为NetBeans构筑Debug环境过程中的一些
注意事项，主要是碰到一些错误。并且在windows这次没有成功。<br/>
特别注意: <em><strong>这里不是手顺</strong></em>。</p>

<h3>正文内容</h3>

<hr />

<ul>
<li>日本語構築手順<br/>
  http://www.terut.net/?p=314</li>
<li>windowsでDebug環境の構築（失敗っちゃた）</li>
</ul>


<p>■gemfiles に「gem 'ruby-debug19'」を追加<br/>
■bundle install を実行する<br/>
■libv8 -v '3.3.10.4'　がインストールされてないです。</p>

<pre><code>原因：Checking for Python...Unable to build libv8: Python not found!
Pythonの環境がないです。

ご参照
http://stackoverflow.com/questions/9174328/fatal-error-while-bundle-install-while-installing-libv8
</code></pre>

<p>■ActivePythonをインストールする<br/>
■再Bundle install して、下記のエラーができ来ました。</p>

<pre><code>Installing therubyracer (0.9.10) with native extensions
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LinuxでNetBeansでrailsのDebug環境の構築]]></title>
    <link href="http://wennylover.github.com/blog/2013/01/25/the-install-of-rails-debug-env-of-netbeans-on-linux/"/>
    <updated>2013-01-25T14:58:00+09:00</updated>
    <id>http://wennylover.github.com/blog/2013/01/25/the-install-of-rails-debug-env-of-netbeans-on-linux</id>
    <content type="html"><![CDATA[<h3>前言</h3>

<hr />

<p>这里只是单纯的记录了自己在ubuntu中为NetBeans构筑Debug环境过程中的一些
注意事项，主要是碰到一些错误。<br/>
特别注意: <em><strong>这里不是手顺</strong></em>。</p>

<h3>正文内容</h3>

<hr />

<p>■一番最新のruby-debug-base19 (0.11.26)のインストールが必要です。</p>

<pre><code>ruby-debug-base19 (0.11.26)
ruby-debug-ide19 (0.4.12)
ruby-debug19 (0.11.6)

gem install ruby-debug19 -- --with-ruby-include=C:\ruby\Ruby193\include\ruby-1.9.1\ruby-1.9.3-p286
curl -OL http://rubyforge.org/frs/download.php/75415/ruby-debug-base19-0.11.26.gem
curl -OL http://rubyforge.org/frs/download.php/75414/linecache19-0.5.13.gem

====ご参照===
https://gist.github.com/1457544
http://ruby-china.org/topics/843
</code></pre>

<p>■environment.rbに下記のメソッドの追加が必要です。</p>

<pre><code># add by dairg 20121101
class String
  def is_binary_data?
    ( self.count( "^ -~", "^\r\n" ).fdiv(self.size) &gt; 0.3 || self.index( "\x00" ) ) unless empty?
  end
end

=====ご参照=====
http://stackoverflow.com/questions/8961367/aptana-3-ruby-debugger-exception-in-debugthread-loop-undefined-method-is-bin/9043481#9043481
</code></pre>

<p>■linecache19 (0.5.13)</p>
]]></content>
  </entry>
  
</feed>
